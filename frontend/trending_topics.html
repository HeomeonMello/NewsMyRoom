<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trending - NewsMyRoom</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/stylesheet.css">
  <link rel="stylesheet" href="css/font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="css/googlefonts-audiowide/googlefont-audiowide.css">
  <link href="favicon.ico" type="image/x-icon" rel="icon" />
  <script src="js/jquery-3.2.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>

  <style>
    .news-container {
      display: flex;
      flex-direction: column;
      margin: 20px;
    }

    .news-item {
      border-bottom: 1px solid #ccc;
      padding: 15px;
    }

    .news-item h3 {
      font-size: 20px;
      color: #333;
    }

    .news-item p {
      color: #555;
      font-size: 16px;
    }

    .news-header {
      text-align: center;
      margin: 20px 0;
    }
  </style>
</head>

<body>
  <div class="wrapper-relative">
    <header>
      <div class="container center">
        <h1 class="header-logo-public" style="font-family: 'Audiowide', serif; font-size: 26pt;">
          <a href="index.html" title="NewsMyRoom" rel="home">NewsMyRoom</a>
        </h1>
      </div>
    </header>

    <div class="container">
      <h1 class="news-header">실시간 인기 뉴스</h1>
      <div id="main" class="row news-container"></div>

      
      <footer>
        <p>&copy; 2024 <a href="index.html">NewsMyRoom</a>. All Rights Reserved.</p>
      </footer>
    </div>
  </div>

  <script>
    var api_url = window.parent.API_URL;

    // 배열을 리스트 형태로 변환하는 함수
    function array_to_ul(x, sep1 = '', sep2 = '') {
      var item = '';
      $.each(x, function (i, e) { item += '<p>' + sep1 + e + sep2 + '</p>'; });
      return item;
    }

    // AJAX 요청
    $.ajax({
      url: api_url,
      type: 'GET',
      dataType: 'json',
      error: function (err) { console.log(err); },
      success: function (d) {
        var body = '';

        // TRENDING
        body += '<div class="col-12 news-section"><div class="news-card">';
        body += '<h4>🔥 TRENDING</h4>' + array_to_ul(d.OverallTrendingTopics);
        body += '</div></div>';

        // TOP PHRASES
        body += '<div class="col-12 news-section"><div class="news-card">';
        body += '<h4>🔑 TOP PHRASES</h4>' + array_to_ul(d.OverallTrendingPhrases);
        body += '</div></div>';

        // Station-specific Topics
        d.StationTrendingTopics.forEach(function (station) {
          body += '<div class="col-md-6 news-section"><div class="news-card">';
          body += '<h4>' + station.Station + ' - 인기 주제</h4>';
          body += array_to_ul(station.Topics, '• ');
          body += '</div></div>';
        });

        // Station-specific Top Topics
        d.StationTopTopics.forEach(function (station) {
          body += '<div class="col-md-6 news-section"><div class="news-card">';
          body += '<h4>' + station.Station + ' - 상위 키워드</h4>';
          body += array_to_ul(station.Topics, '• ');
          body += '</div></div>';
        });

        $("#main").append(body);
      }
    });
  </script>
</body>


</html>